name: Release
on:
  push:
    branches:
    - main

permissions:
  contents: read
  packages: write
  id-token: write

jobs:
  release:
    name: Release
    uses: aquasecurity/trivy/.github/workflows/reusable-release.yaml@55fa6109cd0463fd3221aae41ca7b1d8c44ad430
    with:
      goreleaser_config: goreleaser.yml
      goreleaser_options: '--clean --timeout 90m'
    secrets:
      DOCKERHUB_USER: ${{ secrets.DOCKERHUB_USER }} 
      DOCKERHUB_TOKEN: ${{ secrets.DOCKERHUB_TOKEN }} 
      ECR_ACCESS_KEY_ID: ${{ secrets.ECR_ACCESS_KEY_ID }} 
      ECR_SECRET_ACCESS_KEY: ${{ secrets.ECR_SECRET_ACCESS_KEY }} 
      GPG_KEY: ${{ secrets.GPG_KEY }} 
      ORG_REPO_TOKEN: ${{ secrets.ORG_REPO_TOKEN }} 
      GPG_PASSPHRASE: ${{ secrets.GPG_PASSPHRASE }} 
